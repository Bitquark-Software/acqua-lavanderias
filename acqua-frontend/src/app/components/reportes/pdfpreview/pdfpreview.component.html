<div style="width: 100%; margin: 0 auto; display: flex; flex-direction: column; align-items: center;" *ngIf="isLoading">
    <span class="loading loading-ring loading-lg"></span>
    <h3>Obteniendo reportes</h3>
</div>
<div *ngIf="!isLoading && pdfReporteStats">
    <p *ngIf="pdfReporteStats.tickets.length == 0" style="text-align: center; padding: 4px 0;">
        {{NO_DATA_DEFAULT_MESSAGE}}
    </p>
</div>
<div *ngIf="!isLoading && pdfReporteStats.tickets.length > 0" style="padding: 1em 3em;" #reporteTable>
    <div style="width: 100%; display: flex; justify-content: space-between;">
        <h1 style="font-weight: bold; font-size: 1.3rem; letter-spacing: 0.01px;">Reporte General de Ventas </h1>
        <h2 *ngIf="!startDate && !endDate" style="letter-spacing: 0.01px;">Periodo: Hoy</h2>
        <h2 *ngIf="startDate && endDate" style="letter-spacing: 0.01px;">Periodo: {{startDate.toLocaleDateString('es-MX')}} - {{endDate.toLocaleDateString('es-MX')}}</h2>
    </div>
    <div class="overflow-x-auto">
        <table class="table table-xs table-zebra">
            <thead>
                <th>Folio</th>
                <th>Cliente</th>
                <th>M. Pago</th>
                <th>No. Referencia</th>
                <th>Anticipo</th>
                <th>Restante</th>
                <th>Total</th>
            </thead>
            <tbody>
                <tr *ngFor="let row of pdfReporteStats.tickets">
                    <td class="print:p-0">{{row.id}}</td>
                    <td class="print:p-0">{{row.nombre}}</td>
                    <td class="print:p-0">{{row.metodo_pago.toUpperCase()}}</td>
                    <td class="print:p-0">{{row.numero_referencia ?? '--'}}</td>
                    <td class="print:p-0">$ {{row.anticipo}}</td>
                    <td class="print:p-0">$ {{row.restante}}</td>
                    <td class="print:p-0">$ {{row.total}}</td>
                </tr>
            </tbody>
        </table>
    </div>
    <div class="mt-3 flex flex-row items-end justify-end">
        <table class="table table-xs table-zebra">
            <caption style="letter-spacing: 0.01px;">Totales por forma de pago</caption>
            <thead>
                <th></th>
                <th></th>
            </thead>
            <tbody>
                <tr>
                    <th>Efectivo</th>
                    <td>$ {{pdfReporteStats.efectivo}}</td>
                </tr>
                <tr>
                    <th>Transferencia</th>
                    <td>$ {{pdfReporteStats.transferencia}}</td>
                </tr>
                <tr>
                    <th>Tarjeta</th>
                    <td>$ {{pdfReporteStats.tarjeta}}</td>
                </tr>
            </tbody>
        </table>
    </div>
</div>

<div *ngIf="pdfReporteStats" class="print:hidden">
    <button class="btn w-full btn-success my-3" *ngIf="pdfReporteStats.tickets.length > 0" (click)="downloadReportInPdf()">
        <svg *ngIf="!isDownloadingPdf" class="w-6" aria-hidden="true" fill="none" stroke="currentColor" stroke-width="1.5" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
          <path d="M19.5 14.25v-2.625a3.375 3.375 0 00-3.375-3.375h-1.5A1.125 1.125 0 0113.5 7.125v-1.5a3.375 3.375 0 00-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 00-9-9z" stroke-linecap="round" stroke-linejoin="round"></path>
        </svg>
        <span *ngIf="isDownloadingPdf" class="loading loading-spinner"></span>
        <span *ngIf="isDownloadingPdf">Generando archivo...</span>
        <span *ngIf="!isDownloadingPdf">Imprimir / Guardar</span>
    </button>
</div>